<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ - Checkout</title>
    <link rel="stylesheet" href="cheakoutstyle.css">
    <style>
        /* Ø¥Ø¶Ø§ÙØ© ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¨Ø³ÙŠØ·Ø© Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯ */
        .product-price {
            color: #27ae60;
            font-weight: bold;
            margin-top: 5px;
        }
        .empty-cart-msg {
            text-align: center;
            margin-top: 50px;
            color: #888;
        }
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¨Ø³ÙŠØ· Ù„Ù„ØµÙˆØ±Ø© Ø¹Ø´Ø§Ù† ØªØ¸Ù‡Ø± ØµØ­ */
        .product-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    
    <div class="left-page-frame">
        <p class="frame-text"></p> 
    </div>

    <div class="container">
        <header class="checkout-header">
            <h1 class="header-title">CheckOut products</h1>
            <div class="cart-info">
                <span class="cart-icon">ğŸ›’</span> 
                <span class="item-count" id="cart-count">0</span> 
                <span class="total-price" id="header-total">$0</span>
            </div>
        </header>
        
        <main class="products-list" id="products-container">
            </main>

        <footer class="pay-footer">
            <button class="pay-now-btn" id="final-pay-btn" onclick="goToPayment()">Pay now $0</button>
        </footer>
    </div>

    <script>
        // 1. ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© ÙÙŠ Ø§Ù„Ø³Ù„Ø©
        function displayCheckout() {
            let cart = JSON.parse(localStorage.getItem('myCart')) || [];
            const container = document.getElementById('products-container');
            const cartCount = document.getElementById('cart-count');
            const headerTotal = document.getElementById('header-total');
            const finalPayBtn = document.getElementById('final-pay-btn');

            let total = 0;
            container.innerHTML = ''; 

            if (cart.length === 0) {
                container.innerHTML = '<p class="empty-cart-msg">Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                cartCount.innerText = '0';
                headerTotal.innerText = '$0';
                finalPayBtn.innerText = 'Pay now $0';
                localStorage.setItem('cartTotal', "0"); // ØªØµÙÙŠØ± Ø§Ù„Ø³Ø¹Ø±
                return;
            }

            cartCount.innerText = cart.length;

            cart.forEach((item, index) => {
                let itemPrice = parseFloat(item.price) || 0;
                total += itemPrice;

                container.innerHTML += `
                    <div class="product-item">
                        <div class="product-image-placeholder">
                            <img src="${item.image}" alt="${item.name}" class="product-img">
                        </div>
                        <div class="product-details">
                            <p class="product-name">${item.name}</p>
                            <p class="product-price">$${itemPrice.toFixed(2)}</p>
                        </div>
                        <button class="remove-btn" onclick="removeFromCheckout(${index})">
                            <span class="minus-sign">â€•</span>
                        </button>
                    </div>
                `;
            });

            headerTotal.innerText = `$${total.toFixed(2)}`;
            finalPayBtn.innerText = `Pay now $${total.toFixed(2)}`;
            
            // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¹Ø´Ø§Ù† ØµÙØ­Ø© Ø§Ù„Ù€ payment.html ØªØ´ÙˆÙÙ‡
            localStorage.setItem('cartTotal', total.toFixed(2));
        }

        // 2. ÙˆØ¸ÙŠÙØ© Ø­Ø°Ù Ù…Ù†ØªØ¬ Ù…Ø¹ÙŠÙ† Ù…Ù† Ø§Ù„Ø³Ù„Ø©
        function removeFromCheckout(index) {
            let cart = JSON.parse(localStorage.getItem('myCart')) || [];
            cart.splice(index, 1); 
            localStorage.setItem('myCart', JSON.stringify(cart)); 
            displayCheckout(); 
        }

        // 3. ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹
        function goToPayment() {
            let cart = JSON.parse(localStorage.getItem('myCart')) || [];
            if (cart.length > 0) {
                window.location.href = 'payment.html';
            } else {
                alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©ØŒ Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ø£ÙˆÙ„Ø§Ù‹.");
            }
        }

        window.onload = displayCheckout;
    </script>
</body>
</html>